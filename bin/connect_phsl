#!/bin/bash

OPTIND=1
option=''

function usage() {
   cat <<EOF
Usage: $0 -v|-r
where:
    -t tunnel into phsl environment
    -r spawn an rdp session (vpn needs to be established)
    -v vpn in to phsl environment
EOF
   exit 0
}

while getopts "th?rv" opt; do
    case "$opt" in
		h|\?) usage;;
		r)  [[ -n "$option" ]] && usage || option='rdp' ;;
		v)  [[ -n "$option" ]] && usage || option='vpn' ;;
		t)  [[ -n "$option" ]] && usage || option='tun' ;;
        *) usage;;
    esac
done


if [ "$option" == "rdp" ]; then
	#xfreerdp /u:"George.Murdocca" /v:georgemaws.phoenix.local:3389 /size:90%w:80%h
    xfreerdp /dynamic-resolution /u:"George.Murdocca" /v:georgemaws.phoenix.local:3389
elif [ "$option" == "vpn" ]; then
	sudo openconnect vpn.phoenix.com.mt
elif [ "$option" == "tun" ]; then
    sudo ssh -L 443:localhost:7443 -L 3129:localhost:3129 ubuntu@rogue.linuxdojo.com -p443 -i /home/georgem/.ssh/id_rsa-LinuxDojo_Engineering
else
    usage
fi
